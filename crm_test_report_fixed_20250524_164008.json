{
  "tests": [
    {
      "test": "SUPABASE_URL",
      "status": "PASS",
      "message": "Found: https://jq...",
      "timestamp": "2025-05-24T16:39:30.446384"
    },
    {
      "test": "SUPABASE_ANON_KEY",
      "status": "PASS",
      "message": "Found: eyJhbGciOi...",
      "timestamp": "2025-05-24T16:39:30.446384"
    },
    {
      "test": "OPENAI_API_KEY",
      "status": "PASS",
      "message": "Found: sk-proj-wB...",
      "timestamp": "2025-05-24T16:39:30.446384"
    },
    {
      "test": "CALENDLY_ACCESS_TOKEN",
      "status": "PASS",
      "message": "Found: eyJraWQiOi...",
      "timestamp": "2025-05-24T16:39:30.446384"
    },
    {
      "test": "Supabase Client Init",
      "status": "PASS",
      "message": "Client created successfully",
      "timestamp": "2025-05-24T16:39:30.748337"
    },
    {
      "test": "Health Check",
      "status": "PASS",
      "message": "Database connection OK",
      "timestamp": "2025-05-24T16:39:31.479836"
    },
    {
      "test": "Basic Query",
      "status": "PASS",
      "message": "Query executed, found 1 leads",
      "timestamp": "2025-05-24T16:39:31.691538"
    },
    {
      "test": "Stats Query",
      "status": "PASS",
      "message": "Stats retrieved, total leads: 5, qualified: 5, contacted: 4, meetings: 5, conversations: 5 (active: 0)",
      "timestamp": "2025-05-24T16:39:33.011188"
    },
    {
      "test": "LeadAgent Init",
      "status": "PASS",
      "message": "Agent initialized",
      "timestamp": "2025-05-24T16:39:33.521216"
    },
    {
      "test": "LeadAgent Tools",
      "status": "PASS",
      "message": "Found 4 function calling tools",
      "timestamp": "2025-05-24T16:39:33.521216"
    },
    {
      "test": "OutboundAgent Init",
      "status": "PASS",
      "message": "Agent initialized",
      "timestamp": "2025-05-24T16:39:34.105903"
    },
    {
      "test": "OutboundAgent Tools",
      "status": "PASS",
      "message": "Found 3 function calling tools",
      "timestamp": "2025-05-24T16:39:34.105903"
    },
    {
      "test": "MeetingSchedulerAgent Init",
      "status": "PASS",
      "message": "Agent initialized",
      "timestamp": "2025-05-24T16:39:34.630001"
    },
    {
      "test": "MeetingSchedulerAgent Tools",
      "status": "PASS",
      "message": "Found 4 function calling tools",
      "timestamp": "2025-05-24T16:39:34.630001"
    },
    {
      "test": "Create Lead Operation",
      "status": "PASS",
      "message": "Lead created with ID: 07a9dd53-8250-4c61-9cc7-19055f973466",
      "timestamp": "2025-05-24T16:39:35.433795"
    },
    {
      "test": "Get Lead Operation",
      "status": "PASS",
      "message": "Lead retrieved successfully",
      "timestamp": "2025-05-24T16:39:35.650996"
    },
    {
      "test": "Get Lead by Email",
      "status": "PASS",
      "message": "Lead found by email",
      "timestamp": "2025-05-24T16:39:35.857573"
    },
    {
      "test": "Mark Lead Qualified",
      "status": "PASS",
      "message": "Lead marked as qualified",
      "timestamp": "2025-05-24T16:39:36.098587"
    },
    {
      "test": "Delete Test Lead",
      "status": "PASS",
      "message": "Test lead cleaned up",
      "timestamp": "2025-05-24T16:39:36.310283"
    },
    {
      "test": "Agents System Init",
      "status": "PASS",
      "message": "Agents system initialized",
      "timestamp": "2025-05-24T16:39:38.017262"
    },
    {
      "test": "Complete Workflow",
      "status": "PASS",
      "message": "Lead ID: 52a2ef6b-dee9-43ee-a807-b5477e161ba7, Qualified: True",
      "timestamp": "2025-05-24T16:40:03.985031"
    },
    {
      "test": "Lead Qualification",
      "status": "PASS",
      "message": "Lead qualified successfully",
      "timestamp": "2025-05-24T16:40:03.985031"
    },
    {
      "test": "Outbound Contact",
      "status": "PASS",
      "message": "Message: Hola Carlos, gracias por contactarnos desde Test T...",
      "timestamp": "2025-05-24T16:40:03.985031"
    },
    {
      "test": "Meeting Scheduling",
      "status": "PASS",
      "message": "Type: Sales Call, URL: https://calendly.com/your-company/sales-call-aa72d42c",
      "timestamp": "2025-05-24T16:40:03.985031"
    },
    {
      "test": "Lead Persistence",
      "status": "PASS",
      "message": "Lead found in database: test.lead.20250524163938@testcompany.com",
      "timestamp": "2025-05-24T16:40:04.826452"
    },
    {
      "test": "Lead Status Update",
      "status": "PASS",
      "message": "Lead marked as qualified",
      "timestamp": "2025-05-24T16:40:04.826452"
    },
    {
      "test": "Contact Status Update",
      "status": "PASS",
      "message": "Lead marked as contacted",
      "timestamp": "2025-05-24T16:40:04.826452"
    },
    {
      "test": "Meeting Status Update",
      "status": "PASS",
      "message": "Meeting scheduled",
      "timestamp": "2025-05-24T16:40:04.827449"
    },
    {
      "test": "Conversation Creation",
      "status": "PASS",
      "message": "Found 1 conversations",
      "timestamp": "2025-05-24T16:40:05.040922"
    },
    {
      "test": "Test Lead Deletion",
      "status": "FAIL",
      "message": "Error deleting lead: {'message': 'update or delete on table \"leads\" violates foreign key constraint \"conversations_lead_id_fkey\" on table \"conversations\"', 'code': '23503', 'hint': None, 'details': 'Key is still referenced from table \"conversations\".'}",
      "timestamp": "2025-05-24T16:40:07.326016"
    },
    {
      "test": "Stats Consistency",
      "status": "PASS",
      "message": "Lead count updated: 6 -> 6",
      "timestamp": "2025-05-24T16:40:08.692181"
    }
  ],
  "summary": {
    "overall_status": "\u26a0\ufe0f WARNING",
    "total_passed": 30,
    "total_failed": 1,
    "failed_tests": [
      "   \u2022 Test Lead Deletion - Error deleting lead: {'message': 'update or delete on table \"leads\" violates foreign key constraint \"conversations_lead_id_fkey\" on table \"conversations\"', 'code': '23503', 'hint': None, 'details': 'Key is still referenced from table \"conversations\".'}"
    ],
    "category_results": {
      "ENVIRONMENT": {
        "passed": true,
        "error": null
      },
      "DATABASE": {
        "passed": true,
        "error": null
      },
      "AGENTS": {
        "passed": true,
        "error": null
      },
      "SUPABASE_OPS": {
        "passed": true,
        "error": null
      },
      "WORKFLOW": {
        "passed": true,
        "error": null
      },
      "CLEANUP": {
        "passed": true,
        "error": null
      }
    }
  }
}